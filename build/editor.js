(()=>{"use strict";const e=window.wp.i18n,s=window.wp.hooks,i=window.wp.compose,l=window.wp.blockEditor,t=window.wp.components,o=window.wp.element,r=window.ReactJSXRuntime,c=s=>"object"!=typeof s||null===s?(console.error("Block Style Modifiers: Category must be an object with slug, label, description, and exclusive properties."),{slug:"uncategorized",label:(0,e.__)("Uncategorized","block-style-modifiers"),description:"",exclusive:!1}):{slug:s.slug||"uncategorized",label:s.label||s.slug||"Uncategorized",description:s.description||"",exclusive:!0===s.exclusive};(0,s.addFilter)("blocks.registerBlockType","block-style-modifiers/add-style-modifiers-attribute",e=>(e.attributes={...e.attributes,styleModifiers:{type:"array",default:[]}},e));const a=(0,i.createHigherOrderComponent)(s=>i=>{const{name:a,attributes:n,setAttributes:d}=i,m=(e=>{const s=window.__BLOCK_STYLE_MODIFIERS__||{},i=s["*"]||{};if(Array.isArray(e)){let l={...i};return e.forEach(e=>{const i=s[e]||{};l={...l,...i}}),Object.values(l).map(e=>({class:e.class,label:e.label||e.name,description:e.description||"",category:c(e.category),name:e.name}))}{const l=s[e]||{},t={...i,...l};return Object.values(t).map(e=>({class:e.class,label:e.label||e.name,description:e.description||"",category:c(e.category),name:e.name}))}})(a),f=m.reduce((e,s)=>{const i=s.category,l=i.slug;return e[l]||(e[l]={meta:i,modifiers:[]}),e[l].modifiers.push(s),e},{}),y=n.styleModifiers||[],[p,u]=(0,o.useState)(null),b=(e,s)=>{const i=f[s];if(!i){const s=y.includes(e);return void d(s?{styleModifiers:y.filter(s=>s!==e)}:{styleModifiers:[...y,e]})}if(i.meta.exclusive){const s=i.modifiers.map(e=>e.class),l=y.filter(e=>!s.includes(e));y.includes(e)?d({styleModifiers:l}):d({styleModifiers:[...l,e]})}else{const s=y.includes(e);d(s?{styleModifiers:y.filter(s=>s!==e)}:{styleModifiers:[...y,e]})}},g=()=>{u(null)},_=y.map(e=>m.find(s=>s.class===e)||{class:e,label:e,category:{slug:"uncategorized"}});return(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(s,{...i}),(0,r.jsx)(l.InspectorControls,{children:(0,r.jsxs)(t.PanelBody,{title:(0,e.__)("Style Modifiers","block-style-modifiers"),initialOpen:!0,children:[y.length>0&&(0,r.jsxs)("div",{className:"block-style-modifiers__section",children:[(0,r.jsx)("strong",{className:"block-style-modifiers__section-title",children:(0,e.__)("Selected Modifiers","block-style-modifiers")}),(0,r.jsx)("ul",{className:"block-style-modifiers__selected-list",children:_.map((s,i)=>(0,r.jsxs)("li",{draggable:!0,onDragStart:e=>((e,s)=>{u(s),e.dataTransfer.effectAllowed="move"})(e,i),onDragOver:e=>(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"})(e),onDrop:e=>((e,s)=>{if(e.preventDefault(),null===p||p===s)return;const i=[...y],[l]=i.splice(p,1);i.splice(s,0,l),d({styleModifiers:i}),u(null)})(e,i),onDragEnd:g,title:s.description||s.label,className:"block-style-modifiers__selected-item"+(p===i?" block-style-modifiers__selected-item--dragged":""),children:[(0,r.jsxs)("span",{className:"block-style-modifiers__selected-item-label",children:["⋮⋮ ",s.label]}),(0,r.jsx)(t.Button,{isSmall:!0,variant:"tertiary",icon:"no-alt",onClick:()=>b(s.class,s.category.slug),label:(0,e.__)("Remove","block-style-modifiers")})]},s.class))})]}),0===y.length&&(0,r.jsx)("p",{className:"block-style-modifiers__empty",children:(0,e.__)("No modifiers selected.","block-style-modifiers")}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{className:"block-style-modifiers__available-title",children:(0,e.__)("Available Modifiers","block-style-modifiers")}),Object.keys(f).map(s=>{const i=f[s],l=i.meta,o=i.modifiers;if(l.exclusive){const i=o.find(e=>y.includes(e.class)),c=i?i.class:"",a=[{label:(0,e.__)("None","block-style-modifiers"),value:""},...o.map(e=>({label:e.label,value:e.class}))];return(0,r.jsxs)(t.PanelBody,{title:l.label,initialOpen:!1,children:[l.description&&(0,r.jsx)("p",{className:"block-style-modifiers__category-description",children:l.description}),(0,r.jsx)(t.RadioControl,{selected:c,options:a,onChange:e=>{if(""===e){const e=o.map(e=>e.class);d({styleModifiers:y.filter(s=>!e.includes(s))})}else b(e,s)}})]},s)}return(0,r.jsxs)(t.PanelBody,{title:l.label,initialOpen:!1,children:[l.description&&(0,r.jsx)("p",{className:"block-style-modifiers__category-description",children:l.description}),o.map(e=>(0,r.jsx)(t.CheckboxControl,{label:e.label,help:e.description,checked:y.includes(e.class),onChange:()=>b(e.class,s),__nextHasNoMarginBottom:!0},e.class))]},s)})]})]})})]})},"withStyleModifiers");(0,s.addFilter)("editor.BlockEdit","block-style-modifiers/with-style-modifiers",a),(0,s.addFilter)("blocks.getSaveContent.extraProps","block-style-modifiers/apply-style-modifiers",(e,s,i)=>{if(!i?.styleModifiers?.length)return e;const l=e.className?e.className.split(" "):[];return e.className=[...l,...i.styleModifiers].join(" "),e});const n=(0,i.createHigherOrderComponent)(e=>s=>{const{attributes:i}=s;if(!i?.styleModifiers?.length)return(0,r.jsx)(e,{...s});const l=i.styleModifiers.join(" ");return(0,r.jsx)(e,{...s,className:s.className?`${s.className} ${l}`:l})},"withStyleModifiersOnEditor");(0,s.addFilter)("editor.BlockListBlock","block-style-modifiers/apply-style-modifiers-editor",n)})();