(()=>{"use strict";const e=window.wp.i18n,s=window.wp.hooks,l=window.wp.compose,i=window.wp.blockEditor,t=window.wp.components,o=window.wp.element,r=window.ReactJSXRuntime,a=s=>"object"!=typeof s||null===s?(console.error("Block Style Modifiers: Category must be an object with slug, label, description, and exclusive properties."),{slug:"uncategorized",label:(0,e.__)("Uncategorized","block-style-modifiers"),description:"",exclusive:!1}):{slug:s.slug||"uncategorized",label:s.label||s.slug||"Uncategorized",description:s.description||"",exclusive:!0===s.exclusive};(0,s.addFilter)("blocks.registerBlockType","block-style-modifiers/add-style-modifiers-attribute",e=>(e.attributes={...e.attributes,styleModifiers:{type:"array",default:[]}},e));const c=(0,l.createHigherOrderComponent)(s=>l=>{const{name:c,attributes:n,setAttributes:d}=l,m=(e=>{const s=window.__BLOCK_STYLE_MODIFIERS__||{},l=s["*"]||{};if(Array.isArray(e)){let i={...l};return e.forEach(e=>{const l=s[e]||{};i={...i,...l}}),Object.values(i).map(e=>({class:e.class,label:e.label||e.name,description:e.description||"",category:a(e.category),name:e.name}))}{const i=s[e]||{},t={...l,...i};return Object.values(t).map(e=>({class:e.class,label:e.label||e.name,description:e.description||"",category:a(e.category),name:e.name}))}})(c),f=m.reduce((e,s)=>{const l=s.category,i=l.slug;return e[i]||(e[i]={meta:l,modifiers:[]}),e[i].modifiers.push(s),e},{}),p=n.styleModifiers||[],[y,b]=(0,o.useState)(null),u=(e,s)=>{const l=f[s];if(l)if(l.meta.exclusive){const s=l.modifiers.map(e=>e.class),i=p.filter(e=>!s.includes(e));p.includes(e)?d({styleModifiers:i}):d({styleModifiers:[...i,e]})}else{const s=p.includes(e);d(s?{styleModifiers:p.filter(s=>s!==e)}:{styleModifiers:[...p,e]})}},_=()=>{b(null)},g=p.map(e=>m.find(s=>s.class===e)||{class:e,label:e});return(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(s,{...l}),(0,r.jsx)(i.InspectorControls,{children:(0,r.jsxs)(t.PanelBody,{title:(0,e.__)("Style Modifiers","block-style-modifiers"),initialOpen:!0,children:[p.length>0&&(0,r.jsxs)("div",{className:"block-style-modifiers__section",children:[(0,r.jsx)("strong",{className:"block-style-modifiers__section-title",children:(0,e.__)("Selected Modifiers","block-style-modifiers")}),(0,r.jsx)("ul",{className:"block-style-modifiers__selected-list",children:g.map((s,l)=>(0,r.jsxs)("li",{draggable:!0,onDragStart:e=>((e,s)=>{b(s),e.dataTransfer.effectAllowed="move"})(e,l),onDragOver:e=>(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"})(e),onDrop:e=>((e,s)=>{if(e.preventDefault(),null===y||y===s)return;const l=[...p],[i]=l.splice(y,1);l.splice(s,0,i),d({styleModifiers:l}),b(null)})(e,l),onDragEnd:_,title:s.description||s.label,className:"block-style-modifiers__selected-item"+(y===l?" block-style-modifiers__selected-item--dragged":""),children:[(0,r.jsxs)("span",{className:"block-style-modifiers__selected-item-label",children:["⋮⋮ ",s.label]}),(0,r.jsx)(t.Button,{isSmall:!0,variant:"tertiary",icon:"no-alt",onClick:()=>u(s.class,s.category.slug),label:(0,e.__)("Remove","block-style-modifiers")})]},s.class))})]}),0===p.length&&(0,r.jsx)("p",{className:"block-style-modifiers__empty",children:(0,e.__)("No modifiers selected.","block-style-modifiers")}),(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{className:"block-style-modifiers__available-title",children:(0,e.__)("Available Modifiers","block-style-modifiers")}),Object.keys(f).map(s=>{const l=f[s],i=l.meta,o=l.modifiers;if(i.exclusive){const l=o.find(e=>p.includes(e.class)),a=l?l.class:"",c=[{label:(0,e.__)("None","block-style-modifiers"),value:""},...o.map(e=>({label:e.label,value:e.class}))];return(0,r.jsxs)(t.PanelBody,{title:i.label,initialOpen:!1,children:[i.description&&(0,r.jsx)("p",{className:"block-style-modifiers__category-description",children:i.description}),(0,r.jsx)(t.RadioControl,{selected:a,options:c,onChange:e=>{if(""===e){const e=o.map(e=>e.class);d({styleModifiers:p.filter(s=>!e.includes(s))})}else u(e,s)}})]},s)}return(0,r.jsxs)(t.PanelBody,{title:i.label,initialOpen:!1,children:[i.description&&(0,r.jsx)("p",{className:"block-style-modifiers__category-description",children:i.description}),o.map(e=>(0,r.jsx)(t.CheckboxControl,{label:e.label,help:e.description,checked:p.includes(e.class),onChange:()=>u(e.class,s),__nextHasNoMarginBottom:!0},e.class))]},s)})]})]})})]})},"withStyleModifiers");(0,s.addFilter)("editor.BlockEdit","block-style-modifiers/with-style-modifiers",c),(0,s.addFilter)("blocks.getSaveContent.extraProps","block-style-modifiers/apply-style-modifiers",(e,s,l)=>{if(!l?.styleModifiers?.length)return e;const i=e.className?e.className.split(" "):[];return e.className=[...i,...l.styleModifiers].join(" "),e});const n=(0,l.createHigherOrderComponent)(e=>s=>{const{attributes:l}=s;if(!l?.styleModifiers?.length)return(0,r.jsx)(e,{...s});const i=l.styleModifiers.join(" ");return(0,r.jsx)(e,{...s,className:s.className?`${s.className} ${i}`:i})},"withStyleModifiersOnEditor");(0,s.addFilter)("editor.BlockListBlock","block-style-modifiers/apply-style-modifiers-editor",n)})();